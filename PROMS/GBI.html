<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GBI</title>
    <style>
      body {
        font-family: Montserrat, sans-serif;
        color:black;
      }

      table {
        width: 85%;
        border-collapse: collapse;
        margin-top: 20px;
        margin-bottom: 20px;
        margin-left: auto;
        margin-right: auto;
        border: 1px solid #ddd;
      }



      th, td {
        padding: 5px;
        text-align: center;
      }


      .buttons {
        text-align: center;
        margin-top: 30px;
        margin-left: 10px;

      }

      #gbi input[type="radio"] {
        margin: 5px; 
      }

      
      #answers th {
        font-weight:bold;
        color: black;
        text-align:center;
        border-bottom: 2px solid black; !important;
      }

      #gbi td:nth-child(even) {
        background-color: #ddd;
      }



    </style>
  </head>
  <body>
    <h1 style="text-align: center;">Glasgow Benefit Intervention (GBI)</h1>
    <p style="text-align: center;"> Robinson et al., 1996 </p>
    <p style="text-align: center;"> <b>Instructions : </b></p>
    <p style="text-align: center;">Quel est l’impact de votre <b>intervention</b> (chirurgie, prothèse(s) auditive(s)) sur votre vie actuelle?<br>
      Choisissez la réponse qui se rapproche le plus de votre expérience quotidienne.</p>
    <br>

    <form id="gbi">
      <div id ="answers">
        <table>
          <thead>
            <tr>
              <th style="width:900px;"></th>
              <th style="width:10px;">Très nette amélioration</th>
              <th style="width:10px;">Nette amélioration</th>
              <th style="width:10px;">Pas de changement</th>
              <th style="width:10px;">Légère déterioration</th>
              <th style="width:10px;">Très forte déterioration</th> 
            </tr>
          </thead>
          <tbody>
            <tr>
              <td style="text-align: left;">1. Le résultat de l’intervention a-t-il affecté vos
                activités ? </td>
              <td><input type="radio" name="q1" value="5"></td>
              <td><input type="radio" name="q1" value="4"></td>
              <td><input type="radio" name="q1" value="3"></td>
              <td><input type="radio" name="q1" value="2"></td>
              <td><input type="radio" name="q1" value="1"></td>

            </tr>
            <tr>
              <td style="text-align: left;">2. Les résultats de l’intervention ont-ils rendu
                votre vie plus agréable ou plus désagréable ?</td>
              <td><input type="radio" name="q2" value="5"></td>
              <td><input type="radio" name="q2" value="4"></td>
              <td><input type="radio" name="q2" value="3"></td>
              <td><input type="radio" name="q2" value="2"></td>
              <td><input type="radio" name="q2" value="1"></td>
            </tr>
            <thead>
              <tr>
                <th ></th>
                <th >Beaucoup plus</th>
                <th >Plus</th>
                <th >Pas de changement</th>
                <th >Moins</th>
                <th >Beaucoup moins</th> 
              </tr>
            </thead>

            <tr>
              <td style="text-align: left;">3. Depuis votre intervention, vous sentez-vous plus (ou moins) optimiste face à l’avenir ? </td>
              <td><input type="radio" name="q3" value="5"></td>
              <td><input type="radio" name="q3" value="4"></td>
              <td><input type="radio" name="q3" value="3"></td>
              <td><input type="radio" name="q3" value="2"></td>
              <td><input type="radio" name="q3" value="1"></td>
            </tr>
            <tr>
              <td style="text-align: left;">4. Depuis votre intervention, vous sentez-vous plus (ou moins) gêné(e) lorsque vous vous trouvez en groupe?</td>
              <td><input type="radio" name="q4" value="1"></td>
              <td><input type="radio" name="q4" value="2"></td>
              <td><input type="radio" name="q4" value="3"></td>
              <td><input type="radio" name="q4" value="4"></td>
              <td><input type="radio" name="q4" value="5"></td>
            </tr>
            <tr>
              <td style="text-align: left;">5. Depuis votre opération, avez-vous plus (ou
                moins) de confiance en vous ? </td>
              <td><input type="radio" name="q5" value="5"></td>
              <td><input type="radio" name="q5" value="4"></td>
              <td><input type="radio" name="q5" value="3"></td>
              <td><input type="radio" name="q5" value="2"></td>
              <td><input type="radio" name="q5" value="1"></td>
            </tr>
            <tr>
              <td style="text-align: left;">6. Depuis votre intervention, vous est-il plus (ou
                moins) facile d’avoir affaire à d’autres
                personnes ?</td>
              <td><input type="radio" name="q6" value="5"></td>
              <td><input type="radio" name="q6" value="4"></td>
              <td><input type="radio" name="q6" value="3"></td>
              <td><input type="radio" name="q6" value="2"></td>
              <td><input type="radio" name="q6" value="1"></td>
            </tr>
            <tr>
              <td style="text-align: left;">7. Depuis votre intervention, avez-vous l’impression d’avoir plus (ou moins) de soutien de la part de vos amis ?</td>
              <td><input type="radio" name="q7" value="5"></td>
              <td><input type="radio" name="q7" value="4"></td>
              <td><input type="radio" name="q7" value="3"></td>
              <td><input type="radio" name="q7" value="2"></td>
              <td><input type="radio" name="q7" value="1"></td>
            </tr>
            <tr>
              <td style="text-align: left;">8. Depuis votre intervention, êtes-vous allé(e)
                trouver votre médecin de famille plus (ou moins)
                souvent ?</td>
              <td><input type="radio" name="q8" value="1"></td>
              <td><input type="radio" name="q8" value="2"></td>
              <td><input type="radio" name="q8" value="3"></td>
              <td><input type="radio" name="q8" value="4"></td>
              <td><input type="radio" name="q8" value="5"></td>
            </tr>
            <tr>
              <td style="text-align: left;">9. Depuis votre intervention, vous ressentez-vous
                plus (ou moins) de confiance face à des
                occasions d’emploi?</td>
              <td><input type="radio" name="q9" value="1"></td>
              <td><input type="radio" name="q9" value="2"></td>
              <td><input type="radio" name="q9" value="3"></td>
              <td><input type="radio" name="q9" value="4"></td>
              <td><input type="radio" name="q9" value="5"></td>
            </tr>
            <tr>
              <td style="text-align: left;">10. Depuis votre intervention, vous sentez-vous
                plus timide ou moins timide ? </td>
              <td><input type="radio" name="q10" value="1"></td>
              <td><input type="radio" name="q10" value="2"></td>
              <td><input type="radio" name="q10" value="3"></td>
              <td><input type="radio" name="q10" value="4"></td>
              <td><input type="radio" name="q10" value="5"></td>
            </tr>
            <tr>
              <td style="text-align: left;">11. Depuis votre intervention, y a-t-il davantage ou moins de gens qui s’occupent vraiment de vous ?</td>
              <td><input type="radio" name="q11" value="1"></td>
              <td><input type="radio" name="q11" value="2"></td>
              <td><input type="radio" name="q11" value="3"></td>
              <td><input type="radio" name="q11" value="4"></td>
              <td><input type="radio" name="q11" value="5"></td>
            </tr>
            <tr>
              <td style="text-align: left;">12. Depuis votre intervention, êtes-vous sujet(te) à des rhumes ou infections plus souvent ou moins souvent ?</td>
              <td><input type="radio" name="q12" value="1"></td>
              <td><input type="radio" name="q12" value="2"></td>
              <td><input type="radio" name="q12" value="3"></td>
              <td><input type="radio" name="q12" value="4"></td>
              <td><input type="radio" name="q12" value="5"></td>
            </tr>
            <tr>
              <td style="text-align: left;">13. Depuis votre intervention, devez-vous prendre
                plus (ou moins) de médicaments ?</td>
              <td><input type="radio" name="q13" value="1"></td>
              <td><input type="radio" name="q13" value="2"></td>
              <td><input type="radio" name="q13" value="3"></td>
              <td><input type="radio" name="q13" value="4"></td>
              <td><input type="radio" name="q13" value="5"></td>
            </tr>
            <tr>
              <td style="text-align: left;">14. Depuis votre intervention, vous sentez-vous
                plus (ou moins) en bonne santé? </td>
              <td><input type="radio" name="q14" value="5"></td>
              <td><input type="radio" name="q14" value="4"></td>
              <td><input type="radio" name="q14" value="3"></td>
              <td><input type="radio" name="q14" value="2"></td>
              <td><input type="radio" name="q14" value="1"></td>
            </tr>
            <tr>
              <td style="text-align: left;">15. Depuis votre opération, avez-vous l’impression d’avoir été plus soutenu(e) ou moins soutenu(e) par votre famille ?</td>
              <td><input type="radio" name="q15" value="5"></td>
              <td><input type="radio" name="q15" value="4"></td>
              <td><input type="radio" name="q15" value="3"></td>
              <td><input type="radio" name="q15" value="2"></td>
              <td><input type="radio" name="q15" value="1"></td>
            </tr>
            <tr>
              <td style="text-align: left;">16. Depuis votre intervention, êtes-vous plus (ou moins) gêné(e) par votre problème auditif ? </td>
              <td><input type="radio" name="q16" value="1"></td>
              <td><input type="radio" name="q16" value="2"></td>
              <td><input type="radio" name="q16" value="3"></td>
              <td><input type="radio" name="q16" value="4"></td>
              <td><input type="radio" name="q16" value="5"></td>
            </tr>
            <tr>
              <td style="text-align: left;">17. Depuis votre intervention, avez-vous pu participer à plus (ou moins) d’activités en société ?</td>
              <td><input type="radio" name="q17" value="5"></td>
              <td><input type="radio" name="q17" value="4"></td>
              <td><input type="radio" name="q17" value="3"></td>
              <td><input type="radio" name="q17" value="2"></td>
              <td><input type="radio" name="q17" value="1"></td>
            </tr>
            <tr>
              <td style="text-align: left;">18. Depuis votre intervention, avez-vous plus (ou moins) besoin de vous retrouver seul(e) ?</td>
              <td><input type="radio" name="q18" value="1"></td>
              <td><input type="radio" name="q18" value="2"></td>
              <td><input type="radio" name="q18" value="3"></td>
              <td><input type="radio" name="q18" value="4"></td>
              <td><input type="radio" name="q18" value="5"></td>
            </tr>

          </tbody>
        </table>
      </div> <!--id headers -->

      <div class="buttons">
        <button type="button" onclick="calculateScore()">Calculer le Score</button>
        <button type="reset" onclick="resetForm()">Réinitialiser</button>
      </div>

    </form>

    <div id="result"></div>

    <script>

      function calculateScore() {
        let totalScore = 0;
        let answeredQuestions = 0;

        // Questions for the General Benefit subscale (Q1, Q2, Q3, Q5, Q6, Q7, Q14, Q15, Q17)
        const generalBenefitQuestions = ['q1', 'q2', 'q3', 'q5', 'q6', 'q7', 'q14', 'q15', 'q17'];
        let generalBenefitScore = 0;
        let generalBenefitAnswered = 0;

        // Questions for the Social Support subscale (Q4, Q10, Q11, Q18)
        const socialSupportQuestions = ['q4', 'q10', 'q11', 'q18'];
        let socialSupportScore = 0;
        let socialSupportAnswered = 0;

        // Questions for the Physical Health subscale (Q8, Q9, Q12, Q13, Q16)
        const physicalHealthQuestions = ['q8', 'q9', 'q12', 'q13', 'q16'];
        let physicalHealthScore = 0;
        let physicalHealthAnswered = 0;


        for (let i = 1; i <= 18; i++) {
          const qName = 'q' + i;
          const selectedOption = document.querySelector(`input[name="${qName}"]:checked`);

          if (selectedOption) {
            const value = parseInt(selectedOption.value);
            totalScore += value;
            answeredQuestions++;

            if (generalBenefitQuestions.includes(qName)) {
              generalBenefitScore += value;
              generalBenefitAnswered++;
            } else if (socialSupportQuestions.includes(qName)) {
              socialSupportScore += value;
              socialSupportAnswered++;
            } else if (physicalHealthQuestions.includes(qName)) {
              physicalHealthScore += value;
              physicalHealthAnswered++;
            }
          }
        }


        // Calculate the GBI score based on the formula: (sum of scores - number of questions) / (number of questions * 4) * 100
        // The scores are 1-5, so 'no change' is 3. We normalize around 0.
        // Formula: ((Sum of scores - (3 * Number of questions)) / (2 * Number of questions)) * 100
        // Or, as per the original GBI scoring: ((Sum of scores - number of questions) / (number of questions * 4)) * 100
        // With the values 1-5, a neutral score is 3. So, values -3. Then divide by range (2, since max is 5 (2 above 3) and min is 1 (2 below 3)).
        // And then scale to 100.
        // The original formula: ((Total Score - (3 * Number of questions)) / (2 * Number of questions)) * 100
        // For the GBI, scores range from -100 to +100.
        // A score of 5 gives +2, a score of 4 gives +1, a score of 3 gives 0, a score of 2 gives -1, a score of 1 gives -2.
        // So we need to normalize the values first: (value - 3)
        // Then sum these normalized values, divide by the max possible sum of positive changes, and multiply by 100.
        // Max positive change for one question is 2 (5-3).
        // Max total positive change for 18 questions = 18 * 2 = 36.

        const normalizedTotalScore = totalScore - (3 * answeredQuestions);
        const gbiScore = (normalizedTotalScore / (2 * answeredQuestions)) * 100;


        // Subscale calculations
        const normalizedGeneralBenefitScore = generalBenefitScore - (3 * generalBenefitAnswered);
        const generalBenefitSubscale = (normalizedGeneralBenefitScore / (2 * generalBenefitAnswered)) * 100;

        const normalizedSocialSupportScore = socialSupportScore - (3 * socialSupportAnswered);
        const socialSupportSubscale = (normalizedSocialSupportScore / (2 * socialSupportAnswered)) * 100;

        const normalizedPhysicalHealthScore = physicalHealthScore - (3 * physicalHealthAnswered);
        const physicalHealthSubscale = (normalizedPhysicalHealthScore / (2 * physicalHealthAnswered)) * 100;

		displayscores(gbiScore,generalBenefitSubscale,socialSupportSubscale,physicalHealthSubscale);
        
      }


	function displayscores(gbiScore,generalBenefitSubscale,socialSupportSubscale,physicalHealthSubscale) {
    
    

      const resultDiv = document.getElementById("result");
          resultDiv.innerHTML = `
          Score Total GBI :  ${gbiScore.toFixed(2)}<br>
          Bénéfice Général : ${generalBenefitSubscale.toFixed(2)}<br>
          Soutien Social : ${socialSupportSubscale.toFixed(2)}<br>
          Santé Physique : ${physicalHealthSubscale.toFixed(2)}<br>
          Les scores vont de -100 (bénéfices négatifs) à +100 (bénéfices positifs)

        `;}


      function resetForm() {
        document.getElementById("gbi").reset();
        document.getElementById("result").innerHTML = "";
      }
    </script>
  </body>
</html>
